{% extends 'base.html' %}

{% block title %}{{ template.template_name }} - Minibini{% endblock %}

{% block navigation %}
{% include 'includes/settings_navigation.html' %}
{% endblock %}

{% block content %}
<h2>Work Order Template: {{ template.template_name }}</h2>

<table border="1">
    <tr><th>Field</th><th>Value</th></tr>
    <tr><td>Template ID</td><td>{{ template.template_id }}</td></tr>
    <tr><td>Template Name</td><td>{{ template.template_name }}</td></tr>
    <tr><td>Description</td><td>{{ template.description|default:"-" }}</td></tr>
    <tr><td>Active</td><td>{{ template.is_active|yesno:"Yes,No" }}</td></tr>
    <tr><td>Created Date</td><td>{{ template.created_date }}</td></tr>
</table>

<h3>Task Templates</h3>

{% include 'includes/_bundle_table.html' %}

{% if available_templates %}
<h4>Associate Existing Task Template</h4>
<form method="post">
    {% csrf_token %}
    <div>
        <label for="task_template_id">Task Template:</label>
        <select name="task_template_id" required>
            <option value="">-- Select Task Template --</option>
            {% for task in available_templates %}
            <option value="{{ task.template_id }}">{{ task.template_name }} ({{ task.units|default:"no units" }}, ${{ task.rate|default:"0.00" }})</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <label for="est_qty">Estimated Quantity:</label>
        <input type="number" name="est_qty" step="0.01" value="1.00" min="0" required>
    </div>
    <button type="submit" name="associate_task">Associate Task Template</button>
</form>
{% else %}
<h4>All available task templates are already associated with this work order template.</h4>
{% endif %}

<p>
    <a href="{% url 'jobs:work_order_template_list' %}">Back to Templates List</a>
</p>

{% endblock %}
